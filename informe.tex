\documentclass[12pt,a4paper]{article}

% ======== PAQUETES ========
\usepackage[spanish]{babel}     % Idioma español
\usepackage[utf8]{inputenc}     % Acentos
\usepackage[T1]{fontenc}        % Caracteres correctos
\usepackage{amsmath, amssymb}   % Matemática avanzada
\usepackage{graphicx}           % Insertar imágenes
\usepackage{float}              % Control de posición de figuras
\usepackage{hyperref}           % Hipervínculos
\usepackage{geometry}           % Márgenes
\usepackage{listings}           % Código fuente
\usepackage{xcolor}             % Colores para código
\usepackage{caption}            % Mejoras en captions
\usepackage{subcaption}         % Subfiguras
\usepackage{booktabs}           % Tablas bonitas

% Configuración de márgenes
\geometry{top=2.5cm, bottom=2.5cm, left=2.0cm, right=2.0cm}

% Eliminar sangría en todos los párrafos
\setlength{\parindent}{0pt}

% Configuración del código fuente
\lstset{
    language=Python,
    backgroundcolor=\color{black!5},
    basicstyle=\ttfamily\footnotesize,
    keywordstyle=\color{blue},
    commentstyle=\color{green!50!black},
    stringstyle=\color{orange},
    numbers=left,
    numberstyle=\tiny,
    stepnumber=1,
    frame=single,
    breaklines=true,
    tabsize=4
}

% Datos de la portada
\title{\textbf{Métodos Computacionales - Trabajo Práctico 1}\\
Resoluciones Numéricas de Ecuaciones Diferenciales}
\author{
    Mariño Martina, Martinez Kiara\\ 
    Universidad Torcuato Di Tella
}
\date{\today}

% ======== DOCUMENTO ========
\begin{document}

% ======== PORTADA ========
\maketitle
\thispagestyle{empty}
\newpage

% ======== ÍNDICE ========
\tableofcontents
\newpage

% ======== SECCIONES ========

\part{Ecuación del Calor}

\section{Formulación matemática - Derivación de los métodos explícito e implícito}

En esta sección vamos a ver cómo se llega a las fórmulas de los métodos explícito e implícito para resolver la ecuación del calor usando diferencias finitas.  
La idea es empezar de la ecuación original, discretizarla, y después aproximar las derivadas.

\subsection{La ecuación que queremos resolver}

La ecuación del calor en una dimensión es:
\[
\frac{\partial u}{\partial t} = \alpha \frac{\partial^2 u}{\partial x^2},
\quad x \in (0,1), \quad t > 0
\]

donde:
\begin{itemize}
    \item $u(x,t)$ representa la temperatura en el punto $x$ y tiempo $t$.
    \item $\alpha > 0$ es la constante de difusión térmica.
\end{itemize}

Además, tenemos condiciones de frontera de Dirichlet:
\[
u(0,t) = 0, \quad u(1,t) = 0,
\]
y una condición inicial que nos da la distribución de temperatura al inicio:
\[
u(x,0) = f(x).
\]

En palabras, se trata de una barra de longitud 1 donde los extremos se mantienen a temperatura cero.  
Sabemos cómo estaba la temperatura al comienzo y queremos ver cómo cambia con el tiempo.

\subsection{Discretización: malla de espacio y tiempo}

Para resolver el problema de forma numérica dividimos el espacio y el tiempo en puntos separados por pasos fijos:

\begin{itemize}
    \item Dividimos el intervalo espacial $[0,1]$ en $N$ puntos con separación $\Delta x$.  
    Así, las posiciones son:
    \[
    x_j = j\Delta x, \quad j = 0,1,\dots,N
    \]
    donde $\Delta x = \tfrac{1}{N}$.
    
    \item El tiempo se divide en pasos de tamaño $\Delta t$.  
    Los instantes de tiempo quedan como:
    \[
    t_n = n\Delta t, \quad n = 0,1,2,\dots,M
    \]
    con $M\Delta t = T$ siendo el tiempo final de simulación.
\end{itemize}

Notación: llamamos $u_j^n$ a la aproximación numérica de $u(x_j,t_n)$.  
Los nodos de frontera son $j=0$ y $j=N$ (donde ya conocemos $u$ gracias a las condiciones de borde). Los nodos internos son $j=1,\dots,N-1$, que son los que vamos a actualizar.

\subsection{Aproximación de las derivadas con diferencias finitas}

Reemplazamos las derivadas por aproximaciones usando diferencias finitas:

\begin{itemize}
    \item Para la derivada temporal usamos una \textbf{diferencia hacia adelante}:
    \[
    \frac{\partial u}{\partial t}(x_j,t_n) \approx \frac{u_j^{n+1}-u_j^n}{\Delta t}.
    \]

    \item Para la segunda derivada espacial usamos \textbf{diferencias centradas}:
    \[
    \frac{\partial^2 u}{\partial x^2}(x_j,t_n) \approx \frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{(\Delta x)^2}.
    \]
\end{itemize}

Estas aproximaciones introducen un error, pero mientras $\Delta x$ y $\Delta t$ sean pequeños, la aproximación es bastante buena.

\subsection{Método explícito}

Partimos de la ecuación del calor discretizada:
\[
\frac{u_j^{n+1}-u_j^n}{\Delta t} = \alpha \frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{(\Delta x)^2}.
\]

\subsection*{Definición de $r$:}
Definimos un parámetro muy útil:
\[
r = \frac{\alpha \Delta t}{(\Delta x)^2}.
\]
Este parámetro combina la constante física $\alpha$ con el paso de tiempo $\Delta t$ y el paso espacial $\Delta x$.

\paragraph{Paso 1. Sustituir $r$}  
\[
u_j^{\,n+1}-u_j^{\,n} = r\big(u_{j+1}^{\,n}-2u_j^{\,n}+u_{j-1}^{\,n}\big).
\]

\paragraph{Paso 2. Aislar $u_j^{\,n+1}$}  
\[
u_j^{\,n+1} = u_j^{\,n} + r\big(u_{j+1}^{\,n}-2u_j^{\,n}+u_{j-1}^{\,n}\big).
\]

\paragraph{Paso 3. Expandir el paréntesis}  
\[
u_j^{\,n+1} = u_j^{\,n} + r\,u_{j+1}^{\,n} - 2r\,u_j^{\,n} + r\,u_{j-1}^{\,n}.
\]

\paragraph{Paso 4. Agrupar términos}  
\[
u_j^{\,n+1} = (1 - 2r)u_j^{\,n} + r\,u_{j-1}^{\,n} + r\,u_{j+1}^{\,n}.
\]

El nuevo valor de temperatura en $j$ depende del valor previo en el mismo punto y de sus dos vecinos. Es una combinación lineal:
\begin{itemize}
    \item $(1-2r)u_j^n$ (el valor previo en $j$),
    \item $r\,u_{j-1}^n$ (vecino izquierdo),
    \item $r\,u_{j+1}^n$ (vecino derecho).
\end{itemize}

\paragraph{Esquema explícito}  
\[
\boxed{u_j^{\,n+1} = (1 - 2r)u_j^{\,n} + r\,u_{j-1}^{\,n} + r\,u_{j+1}^{\,n}}
\]

\subsection*{Condición de estabilidad:}
Este método solo funciona bien si se cumple:
\[
r = \frac{\alpha \Delta t}{(\Delta x)^2} \leq \frac{1}{2}.
\]
De lo contrario, la solución numérica se vuelve inestable, con oscilaciones crecientes que no reflejan el fenómeno físico real.

\subsection*{Interpretación:}
La temperatura en $j$ tiende a ``suavizarse'' dependiendo de cómo están los vecinos $j-1$ y $j+1$. Es como un promedio ponderado que se va corrigiendo paso a paso.

\subsection{Método implícito}

Partimos de la misma aproximación temporal, pero evaluando la derivada espacial en $n+1$:
\[
\frac{u_j^{\,n+1}-u_j^{\,n}}{\Delta t}
\approx
\alpha\,\frac{u_{j+1}^{\,n+1}-2u_j^{\,n+1}+u_{j-1}^{\,n+1}}{(\Delta x)^2}.
\]

\paragraph{Paso 1. Multiplicar por $\Delta t$}  
\[
u_j^{\,n+1}-u_j^{\,n}
= \alpha\,\frac{\Delta t}{(\Delta x)^2}\big(u_{j+1}^{\,n+1}-2u_j^{\,n+1}+u_{j-1}^{\,n+1}\big).
\]

\paragraph{Paso 2. Definir $r$ y sustituir}  
\[
r := \frac{\alpha\,\Delta t}{(\Delta x)^2},
\]
\[
u_j^{\,n+1}-u_j^{\,n} = r\big(u_{j+1}^{\,n+1}-2u_j^{\,n+1}+u_{j-1}^{\,n+1}\big).
\]

\paragraph{Paso 3. Reorganizar términos}  
\[
u_j^{\,n+1} - r\big(u_{j+1}^{\,n+1}-2u_j^{\,n+1}+u_{j-1}^{\,n+1}\big) = u_j^{\,n}.
\]

\paragraph{Paso 4. Expandir el paréntesis}  
\[
u_j^{\,n+1} - r\,u_{j+1}^{\,n+1} + 2r\,u_j^{\,n+1} - r\,u_{j-1}^{\,n+1} = u_j^{\,n}.
\]

\paragraph{Paso 5. Agrupar coeficientes}  
\[
-r\,u_{j-1}^{\,n+1} + (1+2r)\,u_j^{\,n+1} - r\,u_{j+1}^{\,n+1} = u_j^{\,n}.
\]

\paragraph{Esquema implícito}  
\[
\boxed{-r\,u_{j-1}^{\,n+1} + (1+2r)\,u_j^{\,n+1} - r\,u_{j+1}^{\,n+1} = u_j^{\,n}}
\]

\subsection*{Interpretación:} 
En este caso cada valor $u_j^{\,n+1}$ está acoplado con sus vecinos en el mismo nivel temporal $n+1$.  
Por eso, no hay una fórmula directa: es necesario resolver un sistema lineal en cada paso.  
La gran ventaja es que el método es \textbf{incondicionalmente estable}, sin restricciones sobre $r$.

\section{Sistemas lineales y forma matricial}

\subsection{Recordemos el dominio}

Tenemos \(N+1\) puntos en el espacio, numerados de \(j=0\) a \(j=N\).  
Los extremos (\(j=0\) y \(j=N\)) son conocidos gracias a las condiciones de frontera \(u(0,t)=u(1,t)=0\). Los valores desconocidos corresponden a los nodos internos \(j=1,2,\dots,N-1\).  

Esto significa que en cada instante de tiempo debemos trabajar con un vector de tamaño \(N-1\), que contiene únicamente los valores de los nodos internos.

\subsection{Método explícito como sistema lineal}

El método explícito en su forma final es:
\[
u_j^{n+1} = (1-2r)u_j^n + r\,u_{j-1}^n + r\,u_{j+1}^n, 
\quad j = 1, 2, \dots, N-1.
\]

\subsection*{Forma matricial:}
Podemos escribir esta relación como:
\[
U^{n+1} = B\,U^n,
\]
donde:
\[
U^n = 
\begin{bmatrix}
u_1^n \\[4pt] u_2^n \\[4pt] \vdots \\[4pt] u_{N-2}^n \\[4pt] u_{N-1}^n
\end{bmatrix}
\]
es el vector con los valores de los nodos internos en el tiempo \(t_n\). \\

La matriz \(B\) tiene estructura tridiagonal:
\[
B = 
\begin{bmatrix}
1-2r & r     & 0     & \cdots & 0 \\[4pt]
r     & 1-2r & r     & \cdots & 0 \\[4pt]
0     & r     & 1-2r & \cdots & 0 \\[4pt]
\vdots& \vdots& \vdots& \ddots & r \\[4pt]
0     & 0     & 0     & r      & 1-2r
\end{bmatrix}.
\]

\subsection*{Interpretación:}
Para pasar del tiempo \(t_n\) al tiempo \(t_{n+1}\), basta con multiplicar el vector \(U^n\) por la matriz \(B\).  
El método explícito se reduce, por lo tanto, a una simple multiplicación matricial.

\subsection{Método implícito como sistema lineal}

En el método implícito, la ecuación para cada nodo es:
\[
-r\,u_{j-1}^{n+1} + (1+2r)\,u_j^{n+1} - r\,u_{j+1}^{n+1} = u_j^n,
\quad j = 1, 2, \dots, N-1.
\]

\subsection*{Forma matricial:} 
Esto se puede escribir como un sistema lineal:
\[
A\,U^{n+1} = U^n,
\]
donde \(U^{n+1}\) es el vector de incógnitas en el nuevo tiempo:
\[
U^{n+1} = 
\begin{bmatrix}
u_1^{n+1} \\[4pt] u_2^{n+1} \\[4pt] \vdots \\[4pt] u_{N-2}^{n+1} \\[4pt] u_{N-1}^{n+1}
\end{bmatrix}.
\] \\

La matriz \(A\) también es tridiagonal, pero con coeficientes distintos:
\[
A = 
\begin{bmatrix}
1+2r & -r    & 0     & \cdots & 0 \\[4pt]
-r    & 1+2r & -r    & \cdots & 0 \\[4pt]
0     & -r    & 1+2r & \cdots & 0 \\[4pt]
\vdots& \vdots& \vdots& \ddots & -r \\[4pt]
0     & 0     & 0     & -r     & 1+2r
\end{bmatrix}.
\]

\subsection*{Interpretación:} 
En este caso, el nuevo vector \(U^{n+1}\) no se puede calcular de forma directa, ya que está involucrado en ambos lados de la ecuación.  
Para avanzar un paso en el tiempo es necesario resolver el sistema lineal:
\[
A\,U^{n+1} = U^n.
\] \\

\paragraph{Resumen comparativo}

\begin{itemize}
    \item \textbf{Explícito:}  
    \[
    U^{n+1} = B\,U^n
    \]
    Evoluciona mediante una multiplicación matricial sencilla.
    
    \item \textbf{Implícito:}  
    \[
    A\,U^{n+1} = U^n
    \]
    Requiere resolver un sistema lineal en cada paso temporal.
\end{itemize}

\section{Conclusiones}

Los métodos implementados fueron evaluados con los parámetros $\alpha = 1$, $\Delta t = 0.001$, $\Delta x = 0.05$ y $T = 0.1$.

\subsection{Análisis de resultados obtenidos}

\paragraph{Condición inicial triangular: $f(x) = 1 - |2x - 1|$}

Para esta condición inicial, ambos métodos produjeron resultados consistentes (ver Figura 1 del notebook - visualizaciones del método explícito e implícito):

\begin{itemize}
    \item \textbf{Método explícito:} La solución evoluciona suavemente desde el perfil triangular inicial hacia un estado más uniforme, con los valores extremos disminuyendo gradualmente. Esta evolución se puede observar en el GIF \texttt{U\_explicito1.gif} generado en el notebook.
    \item \textbf{Método implícito:} Comportamiento similar al explícito, pero con ligeras diferencias en los valores numéricos. La evolución temporal se muestra en el GIF \texttt{U\_implicito1.gif}.
\end{itemize}

\textbf{Valores específicos en $t = 0$:}
\begin{itemize}
    \item $u(0.25, 0) = 0.5000$ (ambos métodos)
    \item $u(0.50, 0) = 1.0000$ (ambos métodos) 
    \item $u(0.75, 0) = 0.5000$ (ambos métodos)
\end{itemize}

\textbf{Valores específicos en $t = T = 0.1$:}
\begin{itemize}
    \item \textbf{Explícito:} $u(0.25, 0.1) = 0.2134$, $u(0.50, 0.1) = 0.3019$, $u(0.75, 0.1) = 0.2134$
    \item \textbf{Implícito:} $u(0.25, 0.1) = 0.2155$, $u(0.50, 0.1) = 0.3048$, $u(0.75, 0.1) = 0.2155$
\end{itemize}

\textbf{Error absoluto entre métodos:}
\begin{itemize}
    \item Error máximo en $t = T$: $2.954 \times 10^{-3}$
    \item Error medio en $t = T$: $1.778 \times 10^{-3}$
\end{itemize}

\paragraph{Condición inicial particionada}

Para la función por tramos definida en los intervalos $[0, 0.25)$, $[0.25, 0.5)$, $[0.5, 0.75)$ y $[0.75, 1]$, se observó (ver Figura 2 del notebook - visualizaciones del método explícito e implícito):

\begin{itemize}
    \item \textbf{Método explícito:} La discontinuidad inicial se suaviza gradualmente, manteniendo la estructura general del perfil inicial. Esta evolución se puede observar en el GIF \texttt{U\_explicito1\_2.gif} generado en el notebook.
    \item \textbf{Método implícito:} Comportamiento similar, con una evolución más suave de las discontinuidades. La evolución temporal se muestra en el GIF \texttt{U\_implicito1\_2.gif}.
\end{itemize}

\textbf{Valores específicos en $t = 0$:}
\begin{itemize}
    \item $u(0.25, 0) = 1.0000$ (ambos métodos)
    \item $u(0.50, 0) = 0.5000$ (ambos métodos)
    \item $u(0.75, 0) = 1.0000$ (ambos métodos)
\end{itemize}

\textbf{Valores específicos en $t = T = 0.1$:}
\begin{itemize}
    \item \textbf{Explícito:} $u(0.25, 0.1) = 0.2394$, $u(0.50, 0.1) = 0.3385$, $u(0.75, 0.1) = 0.2394$
    \item \textbf{Implícito:} $u(0.25, 0.1) = 0.2417$, $u(0.50, 0.1) = 0.3417$, $u(0.75, 0.1) = 0.2417$
\end{itemize}

\textbf{Error absoluto entre métodos:}
\begin{itemize}
    \item Error máximo en $t = T$: $3.264 \times 10^{-3}$
    \item Error medio en $t = T$: $2.004 \times 10^{-3}$
\end{itemize}

\paragraph{Estabilidad y parámetro $r$}

Con los parámetros utilizados, el valor de $r = \frac{\alpha \Delta t}{(\Delta x)^2} = \frac{1 \times 0.001}{(0.05)^2} = 0.4$, que cumple la condición de estabilidad $r \leq 0.5$ para el método explícito. Esto explica la estabilidad observada en ambos casos.

\paragraph{Comparación entre métodos}

\begin{itemize}
    \item \textbf{Precisión:} Ambos métodos producen resultados muy similares, con errores relativos del orden de $10^{-3}$.
    \item \textbf{Comportamiento físico:} Ambos métodos capturan correctamente el fenómeno de difusión térmica, mostrando la tendencia natural hacia el equilibrio térmico.
    \item \textbf{Estabilidad:} El método implícito es incondicionalmente estable, mientras que el explícito requiere $r \leq 0.5$.
    \item \textbf{Consistencia:} En $t=0$ ambos métodos coinciden perfectamente con la condición inicial, confirmando la correcta implementación.
    \item \textbf{Evolución temporal:} A medida que avanza el tiempo, las curvas siguen siendo casi idénticas, validando la consistencia de ambos esquemas.
\end{itemize}

\part{Ecuación de Transporte}

\section{Formulación matemática - Derivación de los métodos explícito e implícito}

En esta sección vamos a aplicar el mismo procedimiento que en la parte 1 - ecuación del calor, pero ahora sobre la ecuación de transporte con velocidad constante $\alpha$:
\[
\frac{\partial u}{\partial t} + \alpha \frac{\partial u}{\partial x} = 0,
\quad x \in (0,1), \quad t > 0
\]

con condición inicial sugerida:
\[
u(x,0) = f(x) = \sin(\pi x).
\]

Aquí $u(x,t)$ describe cómo una cantidad se desplaza en el tiempo a lo largo del eje $x$ con velocidad $\alpha$. \\

Al igual que antes, trabajamos con condiciones de frontera de Dirichlet homogéneas:
\[
u(0,t)=u(1,t)=0
\]

\subsection{Discretización: malla de espacio y tiempo}

La malla espacial y temporal es exactamente la misma que usamos en la ecuación del calor:

\begin{itemize}
    \item Puntos espaciales:
    \[
    x_j = j \Delta x, \quad j = 0,1,\dots,N, \quad \Delta x = \tfrac{1}{N}.
    \]

    \item Puntos temporales:
    \[
    t_n = n\Delta t, \quad n = 0,1,2,\dots,M.
    \]
\end{itemize}

Denotamos la aproximación como $u_j^n \approx u(x_j,t_n)$.

\subsection{Aproximación de las derivadas con diferencias finitas}

Como en la ecuación del calor, aproximamos las derivadas con fórmulas en diferencias finitas.  
La diferencia es que aquí sólo necesitamos la derivada espacial de primer orden.

\begin{itemize}
    \item Derivada temporal: diferencia hacia adelante
    \[
    \frac{\partial u}{\partial t}(x_j,t_n) \approx \frac{u_j^{n+1}-u_j^n}{\Delta t}.
    \]

    \item Derivada espacial: diferencia hacia atrás (esquema para $\alpha>0$)
    \[
    \frac{\partial u}{\partial x}(x_j,t_n) \approx \frac{u_j^n - u_{j-1}^n}{\Delta x}.
    \]
\end{itemize}

\subsection{Método explícito}

Partimos de la ecuación discretizada:
\[
\frac{u_j^{n+1}-u_j^n}{\Delta t} + \alpha \frac{u_j^n - u_{j-1}^n}{\Delta x} = 0.
\]

\subsection*{Definición de $r$:}
Sustituimos $r = \tfrac{\alpha \Delta t}{\Delta x}$:
\[
u_j^{n+1}-u_j^n = -r\,(u_j^n - u_{j-1}^n).
\]

\paragraph{Paso 1. Expandir}  
\[
u_j^{n+1} = u_j^n - r\,u_j^n + r\,u_{j-1}^n.
\]

\paragraph{Paso 2. Agrupar términos}  
\[
u_j^{n+1} = (1-r)\,u_j^n + r\,u_{j-1}^n.
\]

\paragraph{Esquema explícito}  
\[
\boxed{u_j^{\,n+1} = (1-r)\,u_j^n + r\,u_{j-1}^n}
\]

\subsection*{Condición de estabilidad:}
El esquema explícito es estable si y sólo si:
\[
0 \leq r \leq 1.
\]

\subsection*{Interpretación:}
El nuevo valor en $j$ es un promedio ponderado entre el valor anterior en $j$ y el vecino izquierdo $j-1$.  
Esto refleja el transporte de la información en la dirección de la velocidad $\alpha$.

\subsection{Método implícito}

Ahora evaluamos la derivada espacial en el tiempo $n+1$:
\[
\frac{u_j^{n+1}-u_j^n}{\Delta t} + \alpha \frac{u_j^{n+1} - u_{j-1}^{n+1}}{\Delta x} = 0.
\]

\paragraph{Paso 1. Sustituir $r$}  
\[
u_j^{n+1} - u_j^n = -r\,(u_j^{n+1} - u_{j-1}^{n+1}).
\]

\paragraph{Paso 2. Reorganizar}  
\[
u_j^{n+1} - u_j^n = -r\,u_j^{n+1} + r\,u_{j-1}^{n+1}.
\]

\paragraph{Paso 3. Pasar términos de $u_j^{n+1}$ al mismo lado}  
\[
(1+r)\,u_j^{n+1} - r\,u_{j-1}^{n+1} = u_j^n.
\]

\paragraph{Esquema implícito}  
\[
\boxed{(1+r)\,u_j^{\,n+1} - r\,u_{j-1}^{\,n+1} = u_j^n}
\]

\subsection*{Interpretación:}
En este caso, los valores de $u^{n+1}$ aparecen acoplados entre sí.  
Esto obliga a resolver un sistema lineal en cada paso temporal.  
La ventaja es que el método implícito es \textbf{incondicionalmente estable}, sin restricciones sobre $r$.

\section{Sistemas lineales y forma matricial}

\subsection{Recordemos el dominio}
Como ya vimos en la parte 1, trabajamos con $N+1$ puntos espaciales.  
Los valores desconocidos corresponden a los nodos internos $j=1,\dots,N-1$. En cada instante de tiempo usamos un vector de tamaño $N-1$.

\subsection{Método explícito como sistema lineal}

El método explícito se escribe como:
\[
u_j^{n+1} = (1-r)\,u_j^n + r\,u_{j-1}^n.
\]

\subsection*{Forma matricial:}
\[
U^{n+1} = B\,U^n,
\]
con
\[
U^n = 
\begin{bmatrix}
u_1^n \\[4pt] u_2^n \\[4pt] \vdots \\[4pt] u_{N-2}^n \\[4pt] u_{N-1}^n
\end{bmatrix}.
\] \\

La matriz $B$ en este caso es bidiagonal:
\[
B = 
\begin{bmatrix}
1-r & 0   & 0   & \cdots & 0 \\[4pt]
r   & 1-r & 0   & \cdots & 0 \\[4pt]
0   & r   & 1-r & \cdots & 0 \\[4pt]
\vdots & \vdots & \vdots & \ddots & 0 \\[4pt]
0   & 0   & 0   & r      & 1-r
\end{bmatrix}.
\]

\subsection*{Interpretación:}
La evolución temporal se obtiene simplemente multiplicando $U^n$ por $B$. Cada fila refleja la dependencia entre un nodo y su vecino izquierdo.

\subsection{Método implícito como sistema lineal}

El método implícito es:
\[
(1+r)\,u_j^{n+1} - r\,u_{j-1}^{n+1} = u_j^n.
\]

\subsection*{Forma matricial:}
\[
A\,U^{n+1} = U^n,
\]
donde
\[
A = 
\begin{bmatrix}
1+r & 0   & 0   & \cdots & 0 \\[4pt]
-r  & 1+r & 0   & \cdots & 0 \\[4pt]
0   & -r  & 1+r & \cdots & 0 \\[4pt]
\vdots & \vdots & \vdots & \ddots & 0 \\[4pt]
0   & 0   & 0   & -r     & 1+r
\end{bmatrix}.
\]

\subsection*{Interpretación:}
Aquí $U^{n+1}$ está en ambos lados de la ecuación, por lo que en cada paso debemos resolver:
\[
U^{n+1} = A^{-1} U^n.
\]

\subsection{Resumen comparativo}

\begin{itemize}
    \item \textbf{Explícito:}  
    \[
    U^{n+1} = B\,U^n,
    \]
    evolución mediante una multiplicación matricial (bidiagonal).

    \item \textbf{Implícito:}  
    \[
    A\,U^{n+1} = U^n,
    \]
    requiere resolver un sistema lineal en cada paso temporal (también con matriz bidiagonal).
\end{itemize}

\section{Evaluación con parámetros dados}

Se evaluaron las funciones implementadas para la ecuación de transporte con los siguientes parámetros:
\[
\alpha = 1, \quad \Delta t = 0.001, \quad \Delta x = 0.05, \quad T = 0.1
\]

\subsection{Resultados con $f(x) = \sin(\pi x)$}

Las dimensiones de la matriz solución fueron $(101,21)$, correspondientes a 101 pasos temporales y 21 puntos espaciales.

\begin{itemize}
    \item \textbf{Condición inicial (t=0):}
    \[
    u(0.25,0) = 0.7071, \quad u(0.50,0) = 1.0000, \quad u(0.75,0) = 0.7071
    \]

    \item \textbf{Solución en $t = T = 0.1$:}
    \begin{align*}
    u(0.25,0.1) &= 0.4474 \quad (\text{explícito}), & 0.4477 \quad (\text{implícito}) \\
    u(0.50,0.1) &= 0.9287 \quad (\text{explícito}), & 0.9279 \quad (\text{implícito}) \\
    u(0.75,0.1) &= 0.8692 \quad (\text{explícito}), & 0.8683 \quad (\text{implícito})
    \end{align*}
\end{itemize}

\textbf{Error relativo entre métodos en $t=T$:}
\[
\text{Error máximo} \approx 3.0 \times 10^{-1}, \quad \text{Error medio} \approx 1.5 \times 10^{-2}.
\]

Los gráficos muestran que ambos métodos reproducen adecuadamente la forma senoidal inicial y su propagación.  
El error absoluto se concentra en las fronteras debido a las condiciones de Dirichlet.

\subsection{Resultados con condición inicial particionada}

La condición inicial definida en partes fue:
\[
f(x) =
\begin{cases}
4x & 0 \leq x < \tfrac{1}{4}, \\
-2x + \tfrac{3}{2} & \tfrac{1}{4} \leq x < \tfrac{1}{2}, \\
2x - \tfrac{1}{2} & \tfrac{1}{2} \leq x < \tfrac{3}{4}, \\
-4x + 4 & \tfrac{3}{4} \leq x \leq 1.
\end{cases}
\]

Las dimensiones de la matriz solución fueron nuevamente $(101,21)$.

\begin{itemize}
    \item \textbf{Condición inicial (t=0):}
    \[
    u(0.25,0) = 1.0000, \quad u(0.50,0) = 0.5000, \quad u(0.75,0) = 1.0000
    \]

    \item \textbf{Solución en $t = T = 0.1$:}
    \begin{align*}
    u(0.25,0.1) &= 0.6041 \quad (\text{explícito}), & 0.6049 \quad (\text{implícito}) \\
    u(0.50,0.1) &= 0.6938 \quad (\text{explícito}), & 0.6927 \quad (\text{implícito}) \\
    u(0.75,0.1) &= 0.8041 \quad (\text{explícito}), & 0.8049 \quad (\text{implícito})
    \end{align*}
\end{itemize}

\textbf{Error relativo entre métodos en $t=T$:}
\[
\text{Error máximo} \approx 3.9 \times 10^{-1}, \quad \text{Error medio} \approx 2.0 \times 10^{-2}.
\]

En este caso, los gráficos reflejan que ambos métodos capturan la evolución de la forma inicial, aunque las diferencias son algo más notorias en zonas de mayor pendiente.  
Aun así, la propagación se mantiene estable y las discrepancias entre métodos son pequeñas.

\subsection{Observaciones y conclusiones}

\begin{itemize}
    \item Ambos métodos (explícito e implícito) reproducen adecuadamente la propagación de la condición inicial, manteniendo la forma general de la onda y trasladándola en el tiempo.
    \item Las diferencias entre esquemas son pequeñas: los valores numéricos en $t=T$ difieren sólo en el tercer decimal.
    \item El error absoluto entre métodos es bajo en la mayor parte del dominio, concentrándose en las fronteras donde las condiciones de Dirichlet forzadas producen ligeras discrepancias.
    \item Con la condición inicial suave ($\sin(\pi x)$), los dos métodos se comportan casi idénticos. Con la condición inicial particionada, que introduce mayores pendientes y discontinuidades, las diferencias son un poco más notorias pero siguen siendo pequeñas.
    \item El método explícito está condicionado por $r \leq 1$ para estabilidad, mientras que el implícito es incondicionalmente estable. Esto confirma lo esperado teóricamente.
\end{itemize}

\section{Visualización y análisis de resultados}

Se construyeron visualizaciones (gráficos y animaciones en formato GIF) para estudiar cómo evoluciona la solución de la ecuación de transporte a lo largo del tiempo bajo diferentes condiciones iniciales y valores del parámetro $\alpha$.

\subsection*{Comparación entre métodos}
En todos los casos se observa que:
\begin{itemize}
    \item En $t=0$ ambos métodos reproducen exactamente la condición inicial.
    \item Para valores moderados de $\alpha$ (por ejemplo $\alpha=1$), las soluciones del método explícito e implícito permanecen muy cercanas entre sí, con errores absolutos pequeños.
    \item El método explícito presenta restricciones de estabilidad: la condición $r = \frac{\alpha \Delta t}{\Delta x} \leq 1$ debe cumplirse. De lo contrario, aparecen oscilaciones numéricas crecientes (inestabilidad).
    \item El método implícito, en cambio, se mantiene estable incluso cuando $r>1$, aunque introduce una mayor difusión numérica (suavizado de la solución).
\end{itemize}

\subsection*{Estudio del parámetro $\alpha$}
\begin{itemize}
    \item Para $\alpha = 0.5, 1.0, 1.5$ y $2.0$, el esquema explícito produce soluciones razonables y estables, siempre que se respete la condición de estabilidad.
    \item En $\alpha=2.5$, con $\Delta t=0.001$ y $\Delta x=0.05$, se tiene $r=1.25>1$. En este caso, los resultados muestran que:
    \begin{itemize}
        \item El método explícito se vuelve inestable: aparecen oscilaciones grandes y la solución deja de ser físicamente interpretable.
        \item El método implícito se mantiene estable, aunque su solución resulta más difusiva (las oscilaciones se atenúan fuertemente).
    \end{itemize}
\end{itemize}

\subsection*{Visualización con GIFs}
Las animaciones generadas muestran claramente cómo las condiciones iniciales evolucionan en el tiempo:
\begin{itemize}
    \item Con $f(x)=\sin(\pi x)$, la onda inicial se traslada y se suaviza progresivamente.
    \item Con $f(x)$ definida por tramos, se observa cómo los picos y valles iniciales se desplazan y deforman.
\end{itemize}
Los GIFs permiten apreciar en detalle la diferencia entre el método explícito (más sensible a $r$) y el implícito (estable pero más difusivo).

\subsection*{Conclusión general}
\begin{itemize}
    \item Ambos métodos reproducen correctamente la dinámica para $r \leq 1$.
    \item El método explícito es más simple pero limitado por la condición de estabilidad.
    \item El método implícito es más robusto frente a valores grandes de $\alpha$ y pasos temporales mayores, aunque con el costo de mayor difusión numérica y la necesidad de resolver sistemas lineales en cada paso temporal.
\end{itemize}

\end{document}